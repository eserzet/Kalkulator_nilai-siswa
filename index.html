<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Kalkulator Nilai Siswa</title>
<style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
        font-family: 'Poppins', sans-serif;
        background: linear-gradient(135deg, #667eea, #764ba2);
        min-height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 20px;
    }
    .container {
        background: #fff;
        border-radius: 20px;
        box-shadow: 0 20px 60px rgba(0,0,0,0.2);
        padding: 40px;
        max-width: 520px;
        width: 100%;
        animation: fadeIn 0.6s ease;
    }
    @keyframes fadeIn { from{opacity:0; transform:translateY(-30px);} to{opacity:1;transform:translateY(0);} }
    h1 { text-align: center; color: #667eea; margin-bottom: 10px; font-size: 28px; }
    .subtitle { text-align: center; color: #555; margin-bottom: 30px; }
    label { font-weight: 600; color: #333; margin-bottom: 6px; display: block; }
    input, select {
        width: 100%; padding: 10px 14px;
        border: 2px solid #ddd; border-radius: 8px;
        margin-bottom: 5px; transition: 0.3s;
        font-size: 15px;
    }
    input:focus, select:focus {
        border-color: #667eea; outline: none;
        box-shadow: 0 0 6px rgba(102,126,234,0.3);
    }
    .error {
        color: #e74c3c; font-size: 13px; display: none;
        margin-bottom: 10px;
    }
    button {
        width: 48%; border: none; border-radius: 10px;
        padding: 12px; font-weight: 600; cursor: pointer;
        transition: 0.3s; font-size: 16px;
    }
    .btn-calc { background: linear-gradient(135deg,#667eea,#764ba2); color: white; }
    .btn-calc:hover { transform: scale(1.03); }
    .btn-reset { background: #f0f0f0; color: #555; }
    .btn-reset:hover { background: #e0e0e0; }
    .btn-container { display: flex; justify-content: space-between; margin-top: 25px; }

    /* Hasil */
    .result {
        margin-top: 30px;
        padding: 25px;
        border-radius: 15px;
        text-align: center;
        display: none;
        animation: popUp 0.6s ease;
    }
    @keyframes popUp { from{opacity:0; transform:scale(0.9);} to{opacity:1; transform:scale(1);} }
    .result.show { display: block; }
    .grade-display { font-size: 46px; font-weight: bold; margin: 10px 0; }
    .result.lulus { background: linear-gradient(135deg,#11998e,#38ef7d); color:white; }
    .result.tidak-lulus { background: linear-gradient(135deg,#eb3349,#f45c43); color:white; }
    .result-details { margin-top: 20px; text-align: left; }
    .detail-item { display: flex; justify-content: space-between; margin: 6px 0; }
    .btn-print {
        margin-top: 15px; padding: 10px 20px;
        border: none; border-radius: 10px;
        background: white; color: #333; font-weight: 600;
        cursor: pointer; transition: 0.3s;
        margin-right: 10px;
    }
    .btn-print:hover { background: #eee; }
</style>
</head>
<body>
<!-- Load jsPDF library -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<div class="container">
    <h1>üìä Kalkulator Nilai Siswa</h1>
    <p class="subtitle">Hitung rata-rata dari 12 mata pelajaran dengan cepat!</p>

    <form id="gradeForm">
        <label>Nama Siswa</label>
        <input type="text" id="studentName" placeholder="Masukkan nama..." required>

        <label>Kelas</label>
        <select id="studentClass" required>
            <option value="">-- Pilih Kelas --</option>
            <option value="X">X (Sepuluh)</option>
            <option value="XI">XI (Sebelas)</option>
            <option value="XII">XII (Dua Belas)</option>
        </select>

        <div id="subjects"></div>

        <div class="btn-container">
            <button type="submit" class="btn-calc">Hitung</button>
            <button type="button" class="btn-reset" onclick="resetForm()">Reset</button>
        </div>
    </form>

    <div class="result" id="result">
        <h2>Hasil Perhitungan</h2>
        <div class="grade-display" id="finalGrade">-</div>
        <div class="status" id="status">-</div>
        <div class="result-details" id="resultDetails"></div>
        <button class="btn-print" onclick="window.print()">üñ®Ô∏è Cetak</button>
        <button class="btn-print" onclick="downloadPDF()">üì• Download PDF</button>
    </div>
</div>

<script>
    const subjects = [
        "Matematika", "Bahasa Indonesia", "Bahasa Inggris",
        "Fisika", "Biologi", "Kimia",
        "Geografi", "Ekonomi", "Sosiologi",
        "Pendidikan Agama", "Pancasila", "Seni Budaya","Informatika/Algoritma"
    ];
    const subjectsDiv = document.getElementById('subjects');

    // Generate input otomatis
    subjects.forEach((mapel, i) => {
        const group = document.createElement('div');
        group.innerHTML = `
            <label>${i+1}. ${mapel}</label>
            <input type="number" id="mapel${i+1}" placeholder="Nilai (0-100)" min="0" max="100" step="0.01" required>
            <div class="error" id="error${i+1}">Nilai harus 0-100!</div>
        `;
        subjectsDiv.appendChild(group);

        // Validasi real-time
        const input = group.querySelector('input');
        input.addEventListener('input', () => {
            const val = parseFloat(input.value);
            const error = group.querySelector('.error');
            if (val < 0 || val > 100 || isNaN(val)) {
                error.style.display = 'block';
            } else {
                error.style.display = 'none';
            }
        });
    });

    const form = document.getElementById('gradeForm');
    const resultDiv = document.getElementById('result');
    const resultDetails = document.getElementById('resultDetails');

    form.addEventListener('submit', (e) => {
        e.preventDefault();
        let total = 0;
        let valid = true;
        const nilaiPerMapel = [];

        for (let i = 1; i <= subjects.length; i++) {
            const nilai = parseFloat(document.getElementById('mapel'+i).value);
            if (isNaN(nilai) || nilai < 0 || nilai > 100) {
                document.getElementById('error'+i).style.display = 'block';
                valid = false;
            } else {
                document.getElementById('error'+i).style.display = 'none';
                total += nilai;
                nilaiPerMapel.push({ mapel: subjects[i-1], nilai });
            }
        }

        if (!valid) return;

        const rata = total / subjects.length;
        const nama = document.getElementById('studentName').value;
        const kelas = document.getElementById('studentClass').value;

        let status, predikat, kelasHasil;
        if (rata >= 85) {
            status = "üéâ LULUS - Sangat Baik";
            predikat = "A";
            kelasHasil = "lulus";
        } else if (rata >= 75) {
            status = "‚úÖ LULUS - Baik";
            predikat = "B";
            kelasHasil = "lulus";
        } else if (rata >= 65) {
            status = "‚ö†Ô∏è LULUS - Cukup";
            predikat = "C";
            kelasHasil = "lulus";
        } else {
            status = "‚ùå TIDAK LULUS";
            predikat = "D";
            kelasHasil = "tidak-lulus";
        }

        document.getElementById('finalGrade').textContent = rata.toFixed(2);
        document.getElementById('status').textContent = `${status} (${predikat})`;
        resultDiv.className = `result ${kelasHasil} show`;

        // Tampilkan detail hasil
        resultDetails.innerHTML = `
            <div class="detail-item"><span>Nama:</span><span>${nama}</span></div>
            <div class="detail-item"><span>Kelas:</span><span>${kelas}</span></div>
            <div class="detail-item"><span>Total Nilai:</span><span>${total.toFixed(2)}</span></div>
            <div class="detail-item"><span>Rata-rata:</span><span>${rata.toFixed(2)}</span></div>
            <hr>
            ${nilaiPerMapel.map(item => `
                <div class="detail-item">
                    <span>${item.mapel}:</span>
                    <span>${item.nilai}</span>
                </div>
            `).join('')}
        `;
        resultDiv.scrollIntoView({behavior:'smooth'});
    });

    function resetForm() {
        form.reset();
        resultDiv.classList.remove('show');
    }

    // Fungsi Download PDF
    function downloadPDF() {
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF();
        
        const nama = document.getElementById('studentName').value;
        const kelas = document.getElementById('studentClass').value;
        const rata = parseFloat(document.getElementById('finalGrade').textContent);
        const status = document.getElementById('status').textContent;
        
        // Header
        doc.setFontSize(20);
        doc.setTextColor(102, 126, 234);
        doc.text('LAPORAN NILAI SISWA', 105, 20, { align: 'center' });
        
        // Garis pemisah
        doc.setDrawColor(102, 126, 234);
        doc.setLineWidth(0.5);
        doc.line(20, 25, 190, 25);
        
        // Info siswa
        doc.setFontSize(12);
        doc.setTextColor(0, 0, 0);
        doc.text(`Nama Siswa: ${nama}`, 20, 35);
        doc.text(`Kelas: ${kelas}`, 20, 42);
        doc.text(`Tanggal: ${new Date().toLocaleDateString('id-ID')}`, 20, 49);
        
        // Tabel nilai
        doc.setFontSize(11);
        doc.text('DAFTAR NILAI PER MATA PELAJARAN', 20, 60);
        
        let y = 70;
        doc.setLineWidth(0.1);
        
        // Header tabel
        doc.setFillColor(102, 126, 234);
        doc.rect(20, y - 5, 170, 8, 'F');
        doc.setTextColor(255, 255, 255);
        doc.text('No', 25, y);
        doc.text('Mata Pelajaran', 40, y);
        doc.text('Nilai', 170, y);
        
        y += 10;
        doc.setTextColor(0, 0, 0);
        
        // Data nilai
        subjects.forEach((mapel, i) => {
            const nilai = parseFloat(document.getElementById('mapel' + (i+1)).value);
            
            if (i % 2 === 0) {
                doc.setFillColor(240, 240, 240);
                doc.rect(20, y - 5, 170, 8, 'F');
            }
            
            doc.text(`${i+1}`, 25, y);
            doc.text(mapel, 40, y);
            doc.text(nilai.toFixed(2), 170, y);
            y += 8;
        });
        
        // Total dan rata-rata
        y += 5;
        doc.setDrawColor(0, 0, 0);
        doc.line(20, y, 190, y);
        y += 8;
        
        doc.setFontSize(12);
        doc.setFont(undefined, 'bold');
        const totalNilai = subjects.reduce((sum, _, i) => {
            return sum + parseFloat(document.getElementById('mapel' + (i+1)).value);
        }, 0);
        
        doc.text(`Total Nilai: ${totalNilai.toFixed(2)}`, 20, y);
        y += 8;
        doc.text(`Rata-rata: ${rata.toFixed(2)}`, 20, y);
        
        // Status kelulusan
        y += 15;
        doc.setFontSize(14);
        
        if (rata >= 65) {
            doc.setTextColor(17, 153, 142);
            doc.text('STATUS: LULUS', 105, y, { align: 'center' });
        } else {
            doc.setTextColor(235, 51, 73);
            doc.text('STATUS: TIDAK LULUS', 105, y, { align: 'center' });
        }
        
        y += 8;
        doc.setFontSize(12);
        doc.setTextColor(0, 0, 0);
        doc.text(status, 105, y, { align: 'center' });
        
        // Footer
        doc.setFontSize(9);
        doc.setTextColor(128, 128, 128);
        doc.text('Dokumen ini dihasilkan secara otomatis oleh Kalkulator Nilai Siswa', 105, 280, { align: 'center' });
        
        // Simpan PDF
        doc.save(`Laporan_Nilai_${nama.replace(/\s+/g, '_')}_${kelas}.pdf`);
    }
</script>
</body>
</html>